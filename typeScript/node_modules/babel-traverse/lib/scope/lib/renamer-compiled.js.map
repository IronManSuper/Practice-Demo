{"version":3,"sources":["renamer.js"],"names":[],"mappings":"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","file":"renamer-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _binding = require(\"../binding\");\n\nvar _binding2 = _interopRequireDefault(_binding);\n\nvar _babelTypes = require(\"babel-types\");\n\nvar t = _interopRequireWildcard(_babelTypes);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar renameVisitor = {\n  ReferencedIdentifier: function ReferencedIdentifier(_ref, state) {\n    var node = _ref.node;\n\n    if (node.name === state.oldName) {\n      node.name = state.newName;\n    }\n  },\n  Scope: function Scope(path, state) {\n    if (!path.scope.bindingIdentifierEquals(state.oldName, state.binding.identifier)) {\n      path.skip();\n    }\n  },\n  \"AssignmentExpression|Declaration\": function AssignmentExpressionDeclaration(path, state) {\n    var ids = path.getOuterBindingIdentifiers();\n\n    for (var name in ids) {\n      if (name === state.oldName) ids[name].name = state.newName;\n    }\n  }\n};\n\nvar Renamer = function () {\n  function Renamer(binding, oldName, newName) {\n    (0, _classCallCheck3.default)(this, Renamer);\n\n    this.newName = newName;\n    this.oldName = oldName;\n    this.binding = binding;\n  }\n\n  Renamer.prototype.maybeConvertFromExportDeclaration = function maybeConvertFromExportDeclaration(parentDeclar) {\n    var exportDeclar = parentDeclar.parentPath.isExportDeclaration() && parentDeclar.parentPath;\n    if (!exportDeclar) return;\n\n    var isDefault = exportDeclar.isExportDefaultDeclaration();\n\n    if (isDefault && (parentDeclar.isFunctionDeclaration() || parentDeclar.isClassDeclaration()) && !parentDeclar.node.id) {\n      parentDeclar.node.id = parentDeclar.scope.generateUidIdentifier(\"default\");\n    }\n\n    var bindingIdentifiers = parentDeclar.getOuterBindingIdentifiers();\n    var specifiers = [];\n\n    for (var name in bindingIdentifiers) {\n      var localName = name === this.oldName ? this.newName : name;\n      var exportedName = isDefault ? \"default\" : name;\n      specifiers.push(t.exportSpecifier(t.identifier(localName), t.identifier(exportedName)));\n    }\n\n    if (specifiers.length) {\n      var aliasDeclar = t.exportNamedDeclaration(null, specifiers);\n\n      if (parentDeclar.isFunctionDeclaration()) {\n        aliasDeclar._blockHoist = 3;\n      }\n\n      exportDeclar.insertAfter(aliasDeclar);\n      exportDeclar.replaceWith(parentDeclar.node);\n    }\n  };\n\n  Renamer.prototype.maybeConvertFromClassFunctionDeclaration = function maybeConvertFromClassFunctionDeclaration(path) {\n    return;\n\n    if (!path.isFunctionDeclaration() && !path.isClassDeclaration()) return;\n    if (this.binding.kind !== \"hoisted\") return;\n\n    path.node.id = t.identifier(this.oldName);\n    path.node._blockHoist = 3;\n\n    path.replaceWith(t.variableDeclaration(\"let\", [t.variableDeclarator(t.identifier(this.newName), t.toExpression(path.node))]));\n  };\n\n  Renamer.prototype.maybeConvertFromClassFunctionExpression = function maybeConvertFromClassFunctionExpression(path) {\n    return;\n\n    if (!path.isFunctionExpression() && !path.isClassExpression()) return;\n    if (this.binding.kind !== \"local\") return;\n\n    path.node.id = t.identifier(this.oldName);\n\n    this.binding.scope.parent.push({\n      id: t.identifier(this.newName)\n    });\n\n    path.replaceWith(t.assignmentExpression(\"=\", t.identifier(this.newName), path.node));\n  };\n\n  Renamer.prototype.rename = function rename(block) {\n    var binding = this.binding,\n        oldName = this.oldName,\n        newName = this.newName;\n    var scope = binding.scope,\n        path = binding.path;\n\n\n    var parentDeclar = path.find(function (path) {\n      return path.isDeclaration() || path.isFunctionExpression();\n    });\n    if (parentDeclar) {\n      this.maybeConvertFromExportDeclaration(parentDeclar);\n    }\n\n    scope.traverse(block || scope.block, renameVisitor, this);\n\n    if (!block) {\n      scope.removeOwnBinding(oldName);\n      scope.bindings[newName] = binding;\n      this.binding.identifier.name = newName;\n    }\n\n    if (binding.type === \"hoisted\") {}\n\n    if (parentDeclar) {\n      this.maybeConvertFromClassFunctionDeclaration(parentDeclar);\n      this.maybeConvertFromClassFunctionExpression(parentDeclar);\n    }\n  };\n\n  return Renamer;\n}();\n\nexports.default = Renamer;\nmodule.exports = exports[\"default\"];"]}