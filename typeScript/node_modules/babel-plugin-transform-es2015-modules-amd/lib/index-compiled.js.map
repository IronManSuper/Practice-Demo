{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nvar _create = require(\"babel-runtime/core-js/object/create\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nexports.default = function (_ref) {\n  var t = _ref.types;\n\n  function isValidRequireCall(path) {\n    if (!path.isCallExpression()) return false;\n    if (!path.get(\"callee\").isIdentifier({ name: \"require\" })) return false;\n    if (path.scope.getBinding(\"require\")) return false;\n\n    var args = path.get(\"arguments\");\n    if (args.length !== 1) return false;\n\n    var arg = args[0];\n    if (!arg.isStringLiteral()) return false;\n\n    return true;\n  }\n\n  var amdVisitor = {\n    ReferencedIdentifier: function ReferencedIdentifier(_ref2) {\n      var node = _ref2.node,\n          scope = _ref2.scope;\n\n      if (node.name === \"exports\" && !scope.getBinding(\"exports\")) {\n        this.hasExports = true;\n      }\n\n      if (node.name === \"module\" && !scope.getBinding(\"module\")) {\n        this.hasModule = true;\n      }\n    },\n    CallExpression: function CallExpression(path) {\n      if (!isValidRequireCall(path)) return;\n      this.bareSources.push(path.node.arguments[0]);\n      path.remove();\n    },\n    VariableDeclarator: function VariableDeclarator(path) {\n      var id = path.get(\"id\");\n      if (!id.isIdentifier()) return;\n\n      var init = path.get(\"init\");\n      if (!isValidRequireCall(init)) return;\n\n      var source = init.node.arguments[0];\n      this.sourceNames[source.value] = true;\n      this.sources.push([id.node, source]);\n\n      path.remove();\n    }\n  };\n\n  return {\n    inherits: require(\"babel-plugin-transform-es2015-modules-commonjs\"),\n\n    pre: function pre() {\n      this.sources = [];\n      this.sourceNames = (0, _create2.default)(null);\n\n      this.bareSources = [];\n\n      this.hasExports = false;\n      this.hasModule = false;\n    },\n\n\n    visitor: {\n      Program: {\n        exit: function exit(path) {\n          var _this = this;\n\n          if (this.ran) return;\n          this.ran = true;\n\n          path.traverse(amdVisitor, this);\n\n          var params = this.sources.map(function (source) {\n            return source[0];\n          });\n          var sources = this.sources.map(function (source) {\n            return source[1];\n          });\n\n          sources = sources.concat(this.bareSources.filter(function (str) {\n            return !_this.sourceNames[str.value];\n          }));\n\n          var moduleName = this.getModuleName();\n          if (moduleName) moduleName = t.stringLiteral(moduleName);\n\n          if (this.hasExports) {\n            sources.unshift(t.stringLiteral(\"exports\"));\n            params.unshift(t.identifier(\"exports\"));\n          }\n\n          if (this.hasModule) {\n            sources.unshift(t.stringLiteral(\"module\"));\n            params.unshift(t.identifier(\"module\"));\n          }\n\n          var node = path.node;\n\n          var factory = buildFactory({\n            PARAMS: params,\n            BODY: node.body\n          });\n          factory.expression.body.directives = node.directives;\n          node.directives = [];\n\n          node.body = [buildDefine({\n            MODULE_NAME: moduleName,\n            SOURCES: sources,\n            FACTORY: factory\n          })];\n        }\n      }\n    }\n  };\n};\n\nvar _babelTemplate = require(\"babel-template\");\n\nvar _babelTemplate2 = _interopRequireDefault(_babelTemplate);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar buildDefine = (0, _babelTemplate2.default)(\"\\n  define(MODULE_NAME, [SOURCES], FACTORY);\\n\");\n\nvar buildFactory = (0, _babelTemplate2.default)(\"\\n  (function (PARAMS) {\\n    BODY;\\n  })\\n\");\n\nmodule.exports = exports[\"default\"];"]}